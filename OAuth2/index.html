<html>

<head>
    <title>OAuth2 tester</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="initial-scale=1,user-scalable=no,maximum-scale=1,width=device-width">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#000000">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Libraries-->
    <!-- Load Leaflet from -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"
        integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <script src='jquery.oauthpopup.js' type='text/javascript'></script>
</head>

<body>
    <button id="clicky">Click</button>
    <input id="text">

</body>

<script>

    var search = location.search.substring(1);
    var parameters = JSON.parse('{"' + search.replace(/&/g, '","').replace(/=/g, '":"') + '"}', function (key, value) { return key === "" ? value : decodeURIComponent(value) })

    console.log(parameters)

    $("#clicky").click(function (e) {
        $.oauthpopup({
            path: 'https://orcid.org/oauth/authorize?client_id=APP-DLPNQXW5KIQF1YLW&response_type=code&scope=/authenticate&redirect_uri=https://luyuliu.github.io/OAuth2-Test',
            callback: function () {
                document.location.reload(true);
            }
        });


        // $.ajax({
        //         type: "POST",
        //         url: "https://sandbox.orcid.org/signin",
        //         data: {
        //             grant_type: 'client_credentials',
        //             client_id: "APP-DLPNQXW5KIQF1YLW",
        //             client_secret: "9e3f5bd2-b9f0-436c-a050-84e879a17a02"
        //         },
        //         success: success
        //     }
        //     )

    })

    function success(data) {
        var w = window.open('about:blank');
        w.document.open();
        w.document.write(data);
        w.document.close();
        console.log(data)
        $("#text").val("yes")
    }

</script>

</html>